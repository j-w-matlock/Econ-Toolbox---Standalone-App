<Window x:Class="EconToolbox.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:EconToolbox.Desktop.ViewModels"
        xmlns:views="clr-namespace:EconToolbox.Desktop.Views"
        Title="Economic Toolbox" Height="450" Width="600">
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>
    <TabControl Margin="10">
        <TabItem Header="Capital Recovery" DataContext="{Binding CapitalRecovery}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Rate (%)" Margin="0,0,5,5"/>
                <TextBox Text="{Binding Rate}" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Annual interest rate in percent. Higher rates increase the recovery factor."/>
                <TextBlock Text="Periods" Grid.Row="1" Margin="0,0,5,5"/>
                <TextBox Text="{Binding Periods}" Grid.Row="1" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Number of periods. More periods lower each payment."/>
                <Button Content="Compute" Command="{Binding ComputeCommand}" Grid.Row="2" Grid.Column="0" Margin="0,5,5,5"/>
                <Button Content="Export" Command="{Binding ExportCommand}" Grid.Row="2" Grid.Column="1" Margin="0,5,0,5"/>
                <TextBlock Text="{Binding Result}" Grid.Row="3" Grid.ColumnSpan="2"/>
            </Grid>
        </TabItem>
        <TabItem Header="EAD" DataContext="{Binding Ead}">
            <views:EadView/>
        </TabItem>
        <TabItem Header="Storage Cost" DataContext="{Binding StorageCost}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Total Cost" Margin="0,0,5,5"/>
                <TextBox Text="{Binding TotalCost}" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Original total cost of the asset."/>
                <TextBlock Text="Storage Price" Grid.Row="1" Margin="0,0,5,5"/>
                <TextBox Text="{Binding StoragePrice}" Grid.Row="1" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Current storage price."/>
                <TextBlock Text="Reallocated" Grid.Row="2" Margin="0,0,5,5"/>
                <TextBox Text="{Binding StorageReallocated}" Grid.Row="2" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Amount of storage being reallocated."/>
                <TextBlock Text="Total Storage" Grid.Row="3" Margin="0,0,5,5"/>
                <TextBox Text="{Binding TotalStorage}" Grid.Row="3" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Total usable storage capacity."/>
                <Button Content="Compute" Command="{Binding ComputeCommand}" Grid.Row="4" Grid.ColumnSpan="2" Margin="0,5,0,5"/>
                <TextBlock Text="{Binding Result}" Grid.Row="5" Grid.ColumnSpan="2"/>
            </Grid>
        </TabItem>
        <TabItem Header="IDC" DataContext="{Binding Idc}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Total Cost" Margin="0,0,5,5"/>
                <TextBox Text="{Binding TotalInitialCost}" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Total initial project cost."/>
                <TextBlock Text="Rate (%)" Grid.Row="1" Margin="0,0,5,5"/>
                <TextBox Text="{Binding Rate}" Grid.Row="1" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Annual interest rate in percent."/>
                <TextBlock Text="Months" Grid.Row="2" Margin="0,0,5,5"/>
                <TextBox Text="{Binding Months}" Grid.Row="2" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Total number of construction months."/>
                <TextBlock Text="Monthly Costs" Grid.Row="3" Margin="0,0,5,5"/>
                <TextBox Text="{Binding Costs}" Grid.Row="3" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Optional comma-separated monthly costs."/>
                <TextBlock Text="Timings" Grid.Row="4" Margin="0,0,5,5"/>
                <TextBox Text="{Binding Timings}" Grid.Row="4" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Comma-separated timings for each cost (beginning, middle, end)."/>
                <Button Content="Compute" Command="{Binding ComputeCommand}" Grid.Row="5" Grid.ColumnSpan="2" Margin="0,5,0,5"/>
                <TextBlock Text="{Binding Result}" Grid.Row="6" Grid.ColumnSpan="2"/>
            </Grid>
        </TabItem>
        <TabItem Header="Project Annualizer" DataContext="{Binding Annualizer}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="First Cost" Margin="0,0,5,5"/>
                <TextBox Text="{Binding FirstCost}" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Initial project cost."/>
                <TextBlock Text="Rate (%)" Grid.Row="1" Margin="0,0,5,5"/>
                <TextBox Text="{Binding Rate}" Grid.Row="1" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Discount rate in percent."/>
                <TextBlock Text="Annual O&amp;M" Grid.Row="2" Margin="0,0,5,5"/>
                <TextBox Text="{Binding AnnualOm}" Grid.Row="2" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Annual operations and maintenance cost."/>
                <TextBlock Text="Annual Benefits" Grid.Row="3" Margin="0,0,5,5"/>
                <TextBox Text="{Binding AnnualBenefits}" Grid.Row="3" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Expected annual benefits."/>
                <TextBlock Text="Future Costs" Grid.Row="4" Margin="0,0,5,5"/>
                <DataGrid ItemsSource="{Binding FutureCosts}" Grid.Row="4" Grid.Column="1" AutoGenerateColumns="False" Height="100" Margin="0,0,0,5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Cost" Binding="{Binding Cost}"/>
                        <DataGridTextColumn Header="Year" Binding="{Binding Year}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <Button Content="Compute" Command="{Binding ComputeCommand}" Grid.Row="5" Grid.Column="0" Margin="0,5,5,5"/>
                <Button Content="Export" Command="{Binding ExportCommand}" Grid.Row="5" Grid.Column="1" Margin="0,5,0,5"/>
                <TextBlock Text="{Binding Idc, StringFormat=IDC: {0:F2}}" Grid.Row="6" Grid.ColumnSpan="2"/>
                <TextBlock Text="{Binding TotalInvestment, StringFormat=Total Investment: {0:F2}}" Grid.Row="7" Grid.ColumnSpan="2"/>
                <TextBlock Text="{Binding Crf, StringFormat=CRF: {0:F4}}" Grid.Row="8" Grid.ColumnSpan="2"/>
                <TextBlock Text="{Binding AnnualCost, StringFormat=Annual Cost: {0:F2}}" Grid.Row="9" Grid.ColumnSpan="2"/>
                <TextBlock Text="{Binding Bcr, StringFormat=BCR: {0:F2}}" Grid.Row="10" Grid.ColumnSpan="2"/>
            </Grid>
        </TabItem>
        <TabItem Header="Water Demand" DataContext="{Binding WaterDemand}">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="Historical Data" Margin="0,0,5,5"/>
                <DataGrid ItemsSource="{Binding HistoricalData}" Grid.Column="1" AutoGenerateColumns="False" Height="100" Margin="0,0,0,5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Year" Binding="{Binding Year}"/>
                        <DataGridTextColumn Header="Demand" Binding="{Binding Demand}"/>
                    </DataGrid.Columns>
                </DataGrid>
                <TextBlock Text="Forecast Years" Grid.Row="1" Margin="0,0,5,5"/>
                <TextBox Text="{Binding ForecastYears}" Grid.Row="1" Grid.Column="1" Margin="0,0,0,5"
                         ToolTip="Number of years to forecast."/>
                <CheckBox Content="Use Growth Rate" Grid.Row="2" Grid.ColumnSpan="2" IsChecked="{Binding UseGrowthRate}" Margin="0,0,0,5"/>
                <Button Content="Forecast" Command="{Binding ForecastCommand}" Grid.Row="3" Grid.Column="0" Margin="0,5,5,5"/>
                <Button Content="Export" Command="{Binding ExportCommand}" Grid.Row="3" Grid.Column="1" Margin="0,5,0,5"/>
                <DataGrid ItemsSource="{Binding Results}" Grid.Row="4" Grid.ColumnSpan="2" AutoGenerateColumns="True" Height="150" Margin="0,0,0,5"/>
                <Canvas Grid.Row="5" Grid.ColumnSpan="2" Height="150" Width="300">
                    <Polyline Points="{Binding ChartPoints}" Stroke="Blue" StrokeThickness="2"/>
                </Canvas>
            </Grid>
        </TabItem>
        <TabItem Header="Unit Day Value" DataContext="{Binding Udv}">
            <views:UdvView/>
        </TabItem>
    </TabControl>
</Window>
